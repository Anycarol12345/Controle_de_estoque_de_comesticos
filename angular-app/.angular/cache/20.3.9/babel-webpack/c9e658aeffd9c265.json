{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from \"@angular/core\";\nimport { CommonModule } from \"@angular/common\";\nimport { FormsModule } from \"@angular/forms\";\nimport { RouterModule } from \"@angular/router\";\nlet ProdutosComponent = class ProdutosComponent {\n  constructor(apiService) {\n    this.apiService = apiService;\n    this.produtos = [];\n    this.produtosFiltrados = [];\n    this.marcas = [];\n    this.busca = \"\";\n    this.marcaSelecionada = \"\";\n    this.mostrarModal = false;\n    this.produtoEditando = null;\n    this.novoProduto = this.criarProdutoVazio();\n  }\n  ngOnInit() {\n    this.carregarDados();\n  }\n  carregarDados() {\n    this.apiService.getProdutos().subscribe({\n      next: data => {\n        this.produtos = data;\n        this.filtrarProdutos();\n      },\n      error: err => console.error(\"Erro ao carregar produtos:\", err)\n    });\n    this.apiService.getMarcas().subscribe({\n      next: data => this.marcas = data,\n      error: err => console.error(\"Erro ao carregar marcas:\", err)\n    });\n  }\n  filtrarProdutos() {\n    this.produtosFiltrados = this.produtos.filter(p => {\n      const matchBusca = !this.busca || p.nome.toLowerCase().includes(this.busca.toLowerCase()) || p.sku.toLowerCase().includes(this.busca.toLowerCase());\n      const matchMarca = !this.marcaSelecionada || p.marca_id.toString() === this.marcaSelecionada;\n      return matchBusca && matchMarca;\n    });\n  }\n  abrirModal(produto) {\n    if (produto) {\n      this.produtoEditando = produto;\n      this.novoProduto = {\n        ...produto\n      };\n    } else {\n      this.produtoEditando = null;\n      this.novoProduto = this.criarProdutoVazio();\n    }\n    this.mostrarModal = true;\n  }\n  fecharModal() {\n    this.mostrarModal = false;\n    this.produtoEditando = null;\n    this.novoProduto = this.criarProdutoVazio();\n  }\n  salvarProduto() {\n    if (this.produtoEditando) {\n      this.apiService.atualizarProduto(this.produtoEditando.id, this.novoProduto).subscribe({\n        next: () => {\n          this.carregarDados();\n          this.fecharModal();\n        },\n        error: err => console.error(\"Erro ao atualizar produto:\", err)\n      });\n    } else {\n      this.apiService.criarProduto(this.novoProduto).subscribe({\n        next: () => {\n          this.carregarDados();\n          this.fecharModal();\n        },\n        error: err => console.error(\"Erro ao criar produto:\", err)\n      });\n    }\n  }\n  deletarProduto(id) {\n    if (confirm(\"Tem certeza que deseja deletar este produto?\")) {\n      this.apiService.deletarProduto(id).subscribe({\n        next: () => this.carregarDados(),\n        error: err => console.error(\"Erro ao deletar produto:\", err)\n      });\n    }\n  }\n  criarProdutoVazio() {\n    return {\n      nome: \"\",\n      sku: \"\",\n      preco_custo: 0,\n      preco_venda: 0,\n      quantidade_estoque: 0,\n      estoque_minimo: 0,\n      marca_id: 0,\n      tipo_produto: \"perfume\"\n    };\n  }\n  formatarMoeda(valor) {\n    return new Intl.NumberFormat(\"pt-BR\", {\n      style: \"currency\",\n      currency: \"BRL\"\n    }).format(valor);\n  }\n  getNomeMarca(marcaId) {\n    const marca = this.marcas.find(m => m.id === marcaId);\n    return marca?.nome || \"-\";\n  }\n};\nProdutosComponent = __decorate([Component({\n  selector: \"app-produtos\",\n  standalone: true,\n  imports: [CommonModule, FormsModule, RouterModule],\n  templateUrl: \"./produtos.component.html\",\n  styleUrls: [\"./produtos.component.css\"]\n})], ProdutosComponent);\nexport { ProdutosComponent };","map":{"version":3,"names":["Component","CommonModule","FormsModule","RouterModule","ProdutosComponent","constructor","apiService","produtos","produtosFiltrados","marcas","busca","marcaSelecionada","mostrarModal","produtoEditando","novoProduto","criarProdutoVazio","ngOnInit","carregarDados","getProdutos","subscribe","next","data","filtrarProdutos","error","err","console","getMarcas","filter","p","matchBusca","nome","toLowerCase","includes","sku","matchMarca","marca_id","toString","abrirModal","produto","fecharModal","salvarProduto","atualizarProduto","id","criarProduto","deletarProduto","confirm","preco_custo","preco_venda","quantidade_estoque","estoque_minimo","tipo_produto","formatarMoeda","valor","Intl","NumberFormat","style","currency","format","getNomeMarca","marcaId","marca","find","m","__decorate","selector","standalone","imports","templateUrl","styleUrls"],"sources":["C:\\Users\\ANYCA\\Controle_de_estoque_de_comesticos-2\\angular-app\\src\\app\\pages\\produtos\\produtos.component.ts"],"sourcesContent":["import { Component, type OnInit } from \"@angular/core\";\r\nimport { CommonModule } from \"@angular/common\";\r\nimport { FormsModule } from \"@angular/forms\";\r\nimport { RouterModule } from \"@angular/router\";\r\nimport type { ApiService, Produto, Marca } from \"../../service/api.service\";\r\n\r\n@Component({\r\n  selector: \"app-produtos\",\r\n  standalone: true,\r\n  imports: [CommonModule, FormsModule, RouterModule],\r\n  templateUrl: \"./produtos.component.html\",\r\n  styleUrls: [\"./produtos.component.css\"],\r\n})\r\nexport class ProdutosComponent implements OnInit {\r\n  produtos: Produto[] = [];\r\n  produtosFiltrados: Produto[] = [];\r\n  marcas: Marca[] = [];\r\n  busca = \"\";\r\n  marcaSelecionada = \"\";\r\n  mostrarModal = false;\r\n  produtoEditando: Produto | null = null;\r\n\r\n  novoProduto: Produto = this.criarProdutoVazio();\r\n\r\n  constructor(private apiService: ApiService) {}\r\n\r\n  ngOnInit() {\r\n    this.carregarDados();\r\n  }\r\n\r\n  carregarDados() {\r\n    this.apiService.getProdutos().subscribe({\r\n      next: (data: Produto[]) => {\r\n        this.produtos = data;\r\n        this.filtrarProdutos();\r\n      },\r\n      error: (err: unknown) => console.error(\"Erro ao carregar produtos:\", err),\r\n    });\r\n\r\n    this.apiService.getMarcas().subscribe({\r\n      next: (data: Marca[]) => (this.marcas = data),\r\n      error: (err: unknown) => console.error(\"Erro ao carregar marcas:\", err),\r\n    });\r\n  }\r\n\r\n  filtrarProdutos() {\r\n    this.produtosFiltrados = this.produtos.filter((p) => {\r\n      const matchBusca =\r\n        !this.busca ||\r\n        p.nome.toLowerCase().includes(this.busca.toLowerCase()) ||\r\n        p.sku.toLowerCase().includes(this.busca.toLowerCase());\r\n\r\n      const matchMarca =\r\n        !this.marcaSelecionada ||\r\n        p.marca_id.toString() === this.marcaSelecionada;\r\n\r\n      return matchBusca && matchMarca;\r\n    });\r\n  }\r\n\r\n  abrirModal(produto?: Produto) {\r\n    if (produto) {\r\n      this.produtoEditando = produto;\r\n      this.novoProduto = { ...produto };\r\n    } else {\r\n      this.produtoEditando = null;\r\n      this.novoProduto = this.criarProdutoVazio();\r\n    }\r\n    this.mostrarModal = true;\r\n  }\r\n\r\n  fecharModal() {\r\n    this.mostrarModal = false;\r\n    this.produtoEditando = null;\r\n    this.novoProduto = this.criarProdutoVazio();\r\n  }\r\n\r\n  salvarProduto() {\r\n    if (this.produtoEditando) {\r\n      this.apiService\r\n        .atualizarProduto(this.produtoEditando.id!, this.novoProduto)\r\n        .subscribe({\r\n          next: () => {\r\n            this.carregarDados();\r\n            this.fecharModal();\r\n          },\r\n          error: (err: unknown) =>\r\n            console.error(\"Erro ao atualizar produto:\", err),\r\n        });\r\n    } else {\r\n      this.apiService.criarProduto(this.novoProduto).subscribe({\r\n        next: () => {\r\n          this.carregarDados();\r\n          this.fecharModal();\r\n        },\r\n        error: (err: unknown) => console.error(\"Erro ao criar produto:\", err),\r\n      });\r\n    }\r\n  }\r\n\r\n  deletarProduto(id: number) {\r\n    if (confirm(\"Tem certeza que deseja deletar este produto?\")) {\r\n      this.apiService.deletarProduto(id).subscribe({\r\n        next: () => this.carregarDados(),\r\n        error: (err: unknown) => console.error(\"Erro ao deletar produto:\", err),\r\n      });\r\n    }\r\n  }\r\n\r\n  criarProdutoVazio(): Produto {\r\n    return {\r\n      nome: \"\",\r\n      sku: \"\",\r\n      preco_custo: 0,\r\n      preco_venda: 0,\r\n      quantidade_estoque: 0,\r\n      estoque_minimo: 0,\r\n      marca_id: 0,\r\n      tipo_produto: \"perfume\",\r\n    };\r\n  }\r\n\r\n  formatarMoeda(valor: number): string {\r\n    return new Intl.NumberFormat(\"pt-BR\", {\r\n      style: \"currency\",\r\n      currency: \"BRL\",\r\n    }).format(valor);\r\n  }\r\n\r\n  getNomeMarca(marcaId: number): string {\r\n    const marca = this.marcas.find((m) => m.id === marcaId);\r\n    return marca?.nome || \"-\";\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}