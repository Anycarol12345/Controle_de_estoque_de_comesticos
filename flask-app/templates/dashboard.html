{% extends "base.html" %}

{% block title %}Dashboard - Integra+ Estoque{% endblock %}

{% block content %}
<h1 class="text-3xl font-bold mb-6">Dashboard</h1>

<!-- Cards de Estatísticas -->
<div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
    <div class="bg-gray-800 rounded-lg p-6 border border-gray-700">
        <p class="text-gray-400 text-sm mb-2">Total de Produtos</p>
        <p class="text-3xl font-bold">{{ total_produtos }}</p>
    </div>
    <div class="bg-gray-800 rounded-lg p-6 border border-gray-700">
        <p class="text-gray-400 text-sm mb-2">Valor Total em Estoque</p>
        <p class="text-3xl font-bold">R$ {{ "%.2f"|format(valor_total) }}</p>
    </div>
    <div class="bg-gray-800 rounded-lg p-6 border border-gray-700">
        <p class="text-gray-400 text-sm mb-2">Produtos Abaixo do Mínimo</p>
        <p class="text-3xl font-bold text-red-400">{{ produtos_baixo_estoque }}</p>
    </div>
</div>

<div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
    <!-- Movimentações Recentes -->
    <div class="bg-gray-800 rounded-lg p-6 border border-gray-700">
        <h2 class="text-xl font-bold mb-4">Movimentações Recentes</h2>
        <div class="space-y-3">
            {% for mov in movimentacoes_recentes %}
            <div class="flex justify-between items-center p-3 bg-gray-700 rounded">
                <div>
                    <p class="font-medium">{{ mov.produto.nome }}</p>
                    <p class="text-sm text-gray-400">{{ mov.data.strftime('%d/%m/%Y %H:%M') }}</p>
                </div>
                <div class="text-right">
                    <span class="px-2 py-1 rounded text-xs {% if mov.tipo == 'entrada' %}bg-green-900 text-green-300{% else %}bg-red-900 text-red-300{% endif %}">
                        {{ mov.tipo.upper() }}
                    </span>
                    <p class="text-sm mt-1">{{ mov.quantidade }} un</p>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>

    <!-- Alertas de Estoque Baixo -->
    <div class="bg-gray-800 rounded-lg p-6 border border-gray-700">
        <h2 class="text-xl font-bold mb-4">Alertas de Estoque Baixo</h2>
        <div class="space-y-3">
            {% for produto in produtos_alerta %}
            <div class="flex justify-between items-center p-3 bg-gray-700 rounded">
                <div>
                    <p class="font-medium">{{ produto.nome }}</p>
                    <p class="text-sm text-gray-400">{{ produto.marca.nome }}</p>
                </div>
                <div class="text-right">
                    <p class="text-red-400 font-bold">{{ produto.quantidade_estoque }} un</p>
                    <p class="text-xs text-gray-400">Mín: {{ produto.estoque_minimo }}</p>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}
